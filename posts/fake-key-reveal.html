<!DOCTYPE html><html lang="en" class="__variable_aaf875 __variable_11742b"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/3a8dc5763a8ae4b2-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/posts/06.jpg"/><link rel="stylesheet" href="/_next/static/css/af243d7f3466ae7c.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/c3620e9ca5613d68.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/5a2bc2e18c439204.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-cfbc00b856d4972e.js"/><script src="/_next/static/chunks/f14ca715-85481eca1e2aca4e.js" async=""></script><script src="/_next/static/chunks/465-4df10d5a859f0d9b.js" async=""></script><script src="/_next/static/chunks/main-app-274837eb7088a766.js" async=""></script><script src="/_next/static/chunks/618-9024f0767c532a66.js" async=""></script><script src="/_next/static/chunks/435-ef3d6ab01b87f570.js" async=""></script><script src="/_next/static/chunks/969-aad582b925652555.js" async=""></script><script src="/_next/static/chunks/808-a45f86db0de223fb.js" async=""></script><script src="/_next/static/chunks/app/layout-c515227871e7c234.js" async=""></script><script src="/_next/static/chunks/app/page-41b557df63454e1a.js" async=""></script><script src="/_next/static/chunks/app/posts/%5B...slug%5D/page-73618210e21bb040.js" async=""></script><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"/><title>Infeasibility of Fake Key Reveal attacks | Reclaim Protocol</title><meta name="description" content="The provenance of an object is the history of ownership or the origin or the object. Analogously, the provenance of data is the origin of the data, and the changes that may have been made over time by different owners."/><meta name="author" content="hexclanlabs"/><meta property="og:title" content="Infeasibility of Fake Key Reveal attacks"/><meta property="og:description" content="The provenance of an object is the history of ownership or the origin or the object. Analogously, the provenance of data is the origin of the data, and the changes that may have been made over time by different owners."/><meta property="og:url" content="https://example.com/posts/fake-key-reveal"/><meta property="og:image" content="https://example.com/api/og?title=Infeasibility+of+Fake+Key+Reveal+attacks"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image:alt" content="Infeasibility of Fake Key Reveal attacks"/><meta property="og:type" content="article"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Infeasibility of Fake Key Reveal attacks"/><meta name="twitter:description" content="The provenance of an object is the history of ownership or the origin or the object. Analogously, the provenance of data is the origin of the data, and the changes that may have been made over time by different owners."/><meta name="twitter:image" content="https://example.com/api/og?title=Infeasibility+of+Fake+Key+Reveal+attacks"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="antialiased text-gray-800 dark:bg-black dark:text-gray-400"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><nav class="container px-8 mx-auto max-w-screen-lg xl:px-5 py-6 lg:py-8"><div class="flex flex-wrap justify-between md:flex-nowrap md:gap-14"><div class="order-1 hidden w-full flex-col items-center justify-start md:order-none md:flex md:w-auto md:flex-1 md:flex-row md:justify-end"><a class="px-5 py-2 text-base font-medium text-gray-600 hover:text-blue-500 dark:text-gray-400" href="/">Home</a><a href="https://dev.reclaimprotocol.org/dashboard" target="_blank" rel="noopener noreferrer" class="px-5 py-2 text-base font-medium text-gray-600 hover:text-blue-500 dark:text-gray-400">Dashboard</a><a href="https://t.me/protocolreclaim" target="_blank" rel="noopener noreferrer" class="px-5 py-2 text-base font-medium text-gray-600 hover:text-blue-500 dark:text-gray-400">Community</a></div><div class="flex w-full items-center justify-between md:w-auto"><a href="/"><img alt="logo" loading="lazy" width="36" height="41" decoding="async" data-nimg="1" class="w-8 md:w-10" style="color:transparent" src="/_next/static/media/main.83eeff90.svg"/></a><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 py-2 w-10 px-0 sm:hidden" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R19ja:" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-5 w-5"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg><span class="sr-only">Toggle Mobile Nav</span></button></div><div class="order-2 hidden w-full flex-col items-center justify-start md:order-none md:flex md:w-auto md:flex-1 md:flex-row"><a class="px-5 py-2 text-base font-medium text-gray-600 hover:text-blue-500 dark:text-gray-400" href="/page/1">Blogs</a><a href="https://www.reclaimprotocol.org/whitepaper" target="_blank" rel="noopener noreferrer" class="px-5 py-2 text-base font-medium text-gray-600 hover:text-blue-500 dark:text-gray-400">Whitepaper</a><a href="https://docs.reclaimprotocol.org/" target="_blank" rel="noopener noreferrer" class="px-5 py-2 text-base font-medium text-gray-600 hover:text-blue-500 dark:text-gray-400">Docs</a></div></div></nav><main><article class="container py-6 prose dark:prose-invert max-w-3xl mx-auto"><h1 class="mb-2 text-center">Infeasibility of Fake Key Reveal attacks</h1><div class="text-center"><div>Madhavan Malolan</div><div>Oct 12, 2023</div></div><img src="/posts/06.jpg" alt="Infeasibility of Fake Key Reveal attacks" class="rounded" width="1920" height="1080"/><div class="flex gap-2 mb-2"><span class="inline-block text-xs font-medium tracking-wider uppercase mt-5 text-blue-600">Code</span><span class="inline-block text-xs font-medium tracking-wider uppercase mt-5 text-blue-600">Not Code</span></div><p>The goal of an Adversary in the Fake Key Reveal attacks is to compute a key such that the result of decryption of the TLS response (that came from the Website) using this key will be a plaintext that contains some specific substrings on the Adversary’s choice. Let’s take a closer look at how the Reclaim’s selective disclosure of the Server’s TLS response works to understand how these attacks can potentially harm Reclaim:</p>
<ol>
<li>The Server sends the encrypted TLS response to the Attestor</li>
<li>The Attestor transfers this ciphertext further to the User</li>
<li>The User decrypts the TLS response using the key K1 (that is unknown to the Attestor, and was derived between the User and the Server during the TLS Handshake phase), and replaces all the symbols they want to hide with a gibberish symbol</li>
<li>Now, the User wants to trick the Attestor and prove them that this ciphertext can be decrypted into a string that contains some information that the User wants there to be</li>
<li>For this purpose the User (somehow) computes a different key K2 such that the encrypted TLS response will be decrypted to a plaintext containing an arbitrary substring (on User’s choice)</li>
<li>After that, the User creates a zk-proof of knowledge of the key K2, and reveals the result of decryption of the TLS response using K2 to the Attestor. Thus, this revealed plaintext includes the data that the User wanted to show, and not the data that really came from the Website</li>
</ol>
<h1 id="why-does-this-issue-arise"><a class="subheading-anchor" aria-label="Link to section" href="#why-does-this-issue-arise">Why does this issue arise?</a></h1>
<p>The issue of the computation of the second key such that it decrypts a chosen ciphertext into a chosen by the Adversary plaintext first got attention in two papers [<a href="https://eprint.iacr.org/2017/664.pdf">1</a>, <a href="https://eprint.iacr.org/2019/016.pdf">2</a>]. Those papers offer attacks that can be exploited against differently encryption schemes with authentication tag (AEAD). The issue they emphasize is that under some conditions an encryption scheme with authentication tag does not provide a unique correct decryption (the decryption is considered correct if the authentication tag verification is successful).</p>
<h1 id="reclaims-protection-against-such-attacks"><a class="subheading-anchor" aria-label="Link to section" href="#reclaims-protection-against-such-attacks">Reclaim’s protection against such attacks</a></h1>
<p>There are two main reasons why the attack vector mentioned above is infeasible against the Reclaim protocol:</p>
<ol>
<li>First of all, the attacks above are possible if and only if the Adversary (the User in our case) controls or can choose both ciphertexts and keys. This and only this can lead them to exploiting the vulnerabilities mentioned above. However, in Reclaim the User does not control the ciphertext of the Website’s TLS response, and does not control the encryption key (which has been derived following the TLS protocol). This means that the fake key reveal attack is not applicable here.</li>
<li>Second, the success of these attacks is determined by the correct tag check while decrypting the ciphertext. However, in Reclaim there is no tag check at all. The reason behind the absence of tag verification is that Reclaim verifies the content of the decrypted TLS response instead. So, the mechanism of determination of success or failure of an attack would work differently in our case. This also means that attacks mentioned above are not applicable here.</li>
</ol>
<p>These all lead the Adversary to the only strategy they can use against Reclaim in order to perform a fake key reveal attack: a key brute-force. The key brute-force attack, however, would be quite easy for an adversary to perform if Reclaim does not require Users to disclose enough (known in advance by an Attestor) bytes of TLS response.</p>
<p>Let’s say, a User is proving that they have $1000 on their bank account, and the TLS Response from the bank’s website is “Good morning Mike; account number: 123; balance: 1000”. If Reclaim asks the user to disclose one number only (the number that represents the balance), then it would be extremely easy for a User to brute-force the key such that the decryption contains “1000” even at a specific position in the string. However, we can require a User to disclose more bytes of the TLS response to be sure that it is not just a random number appeared in the decryption but indeed the bank balance of the User. Moreover, since the format of the TLS response is well-known to an Attestor (since it is specified by the provider parameters), a User will have to disclose exactly the same bytes as the real TLS response contains (e.g. “account number: ***; balance: 1000”). This makes the brute-force a way more challenging problem. The reason behind this is that a User has to iterate through 2^N keys, where N is the number of <em>bits</em> they have to disclose. In the case of Reclaim, we require Users to disclose 16 bytes of data. Hence, even if a User exploits one of the most high-speed ChaCha20 implementations (560 MB/s encryption speed) it will take them about <em>200 trillion years</em> to perform such a brute-force.</p></article></main><div class="container px-8 mx-auto xl:px-5  max-w-screen-lg py-5 lg:py-8 mt-10 border-t border-gray-100 dark:border-gray-800"><div class="text-center text-sm">Copyright © <!-- -->2024<!-- --> Reclaim Protocol. All rights reserved.</div><div class="mt-2 flex items-center justify-center"><div class="inline-flex items-center"><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 false border border-slate-200" type="button" id="radix-:Rbja:" aria-haspopup="menu" aria-expanded="false" data-state="closed"><span class="block dark:hidden">Light</span><span class="hidden dark:block">Dark</span><span class="sr-only">Toggle Theme</span></button></div></div></div><script src="/_next/static/chunks/webpack-cfbc00b856d4972e.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/3a8dc5763a8ae4b2-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n3:HL[\"/_next/static/css/af243d7f3466ae7c.css\",\"style\"]\n4:HL[\"/_next/static/css/c3620e9ca5613d68.css\",\"style\"]\n5:HL[\"/_next/static/css/5a2bc2e18c439204.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"6:I[5726,[],\"\"]\n9:I[1699,[],\"\"]\nb:I[2579,[],\"\"]\nc:I[1425,[\"618\",\"static/chunks/618-9024f0767c532a66.js\",\"435\",\"static/chunks/435-ef3d6ab01b87f570.js\",\"969\",\"static/chunks/969-aad582b925652555.js\",\"808\",\"static/chunks/808-a45f86db0de223fb.js\",\"185\",\"static/chunks/app/layout-c515227871e7c234.js\"],\"Providers\"]\nd:I[9618,[\"618\",\"static/chunks/618-9024f0767c532a66.js\",\"931\",\"static/chunks/app/page-41b557df63454e1a.js\"],\"\"]\ne:I[5969,[\"969\",\"static/chunks/969-aad582b925652555.js\",\"49\",\"static/chunks/app/posts/%5B...slug%5D/page-73618210e21bb040.js\"],\"Image\"]\nf:I[845,[\"618\",\"static/chunks/618-9024f0767c532a66.js\",\"435\",\"static/chunks/435-ef3d6ab01b87f570.js\",\"969\",\"static/chunks/969-aad582b925652555.js\",\"808\",\"static/chunks/808-a45f86db0de223fb.js\",\"185\",\"static/chunks/app/layout-c515227871e7c234.js\"],\"MobileNav\"]\n10:I[3378,[\"618\",\"static/chunks/618-9024f0767c532a66.js\",\"435\",\"static/chunks/435-ef3d6ab01b87f570.js\",\"969\",\"static/chunks/969-aad582b925652555.js\",\"808\",\"static/chunks/808-a45f86db0de223fb.js\",\"185\",\"static/chunks/app/layout-c515227871e7c234.js\"],\"ModeToggle\"]\n12:I[3141,[],\"\"]\na:[\"slug\",\"fake-key-reveal\",\"c\"]\n13:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/af243d7f3466ae7c.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/c3620e9ca5613d68.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L6\",null,{\"buildId\":\"KOC9BHodku9XeBBLWMxsr\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/fake-key-reveal\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"fake-key-reveal\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"fake-key-reveal\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"fake-key-reveal\",\"c\"],{\"children\":[\"__PAGE__\",{},[[\"$L7\",\"$L8\"],null],null]},[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",\"$a\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/5a2bc2e18c439204.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}],null]},[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"__variable_aaf875 __variable_11742b\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"antialiased text-gray-800 dark:bg-black dark:text-gray-400\",\"children\":[\"$\",\"$Lc\",null,{\"children\":[[\"$\",\"nav\",null,{\"className\":\"container px-8 mx-auto max-w-screen-lg xl:px-5 py-6 lg:py-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-wrap justify-between md:flex-nowrap md:gap-14\",\"children\":[[\"$\",\"div\",null,{\"className\":\"order-1 hidden w-full flex-col items-center justify-start md:order-none md:flex md:w-auto md:flex-1 md:flex-row md:justify-end\",\"children\":[[\"$\",\"$Ld\",null,{\"href\":\"/\",\"className\":\"px-5 py-2 text-base font-medium text-gray-600 hover:text-blue-500 dark:text-gray-400\",\"children\":\"Home\"}],[\"$\",\"a\",null,{\"href\":\"https://dev.reclaimprotocol.org/dashboard\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"px-5 py-2 text-base font-medium text-gray-600 hover:text-blue-500 dark:text-gray-400\",\"children\":\"Dashboard\"}],[\"$\",\"a\",null,{\"href\":\"https://t.me/protocolreclaim\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"px-5 py-2 text-base font-medium text-gray-600 hover:text-blue-500 dark:text-gray-400\",\"children\":\"Community\"}]]}],[\"$\",\"div\",null,{\"className\":\"flex w-full items-center justify-between md:w-auto\",\"children\":[[\"$\",\"$Ld\",null,{\"href\":\"/\",\"children\":[\"$\",\"$Le\",null,{\"src\":{\"src\":\"/_next/static/media/main.83eeff90.svg\",\"height\":41,\"width\":36,\"blurWidth\":0,\"blurHeight\":0},\"alt\":\"logo\",\"className\":\"w-8 md:w-10\"}]}],[\"$\",\"$Lf\",null,{}]]}],[\"$\",\"div\",null,{\"className\":\"order-2 hidden w-full flex-col items-center justify-start md:order-none md:flex md:w-auto md:flex-1 md:flex-row\",\"children\":[[\"$\",\"$Ld\",null,{\"href\":\"/page/1\",\"className\":\"px-5 py-2 text-base font-medium text-gray-600 hover:text-blue-500 dark:text-gray-400\",\"children\":\"Blogs\"}],[\"$\",\"a\",null,{\"href\":\"https://www.reclaimprotocol.org/whitepaper\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"px-5 py-2 text-base font-medium text-gray-600 hover:text-blue-500 dark:text-gray-400\",\"children\":\"Whitepaper\"}],[\"$\",\"a\",null,{\"href\":\"https://docs.reclaimprotocol.org/\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"px-5 py-2 text-base font-medium text-gray-600 hover:text-blue-500 dark:text-gray-400\",\"children\":\"Docs\"}]]}]]}]}],[\"$\",\"main\",null,{\"children\":[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}],[\"$\",\"div\",null,{\"className\":\"container px-8 mx-auto xl:px-5  max-w-screen-lg py-5 lg:py-8 mt-10 border-t border-gray-100 dark:border-gray-800\",\"children\":[[\"$\",\"div\",null,{\"className\":\"text-center text-sm\",\"children\":[\"Copyright © \",2024,\" Reclaim Protocol. All rights reserved.\"]}],[\"$\",\"div\",null,{\"className\":\"mt-2 flex items-center justify-center\",\"children\":[\"$\",\"div\",null,{\"className\":\"inline-flex items-center\",\"children\":[\"$\",\"$L10\",null,{}]}]}]]}]]}]}]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$L11\"],\"globalErrorComponent\":\"$12\",\"missingSlots\":\"$W13\"}]]\n"])</script><script>self.__next_f.push([1,"14:T412,Let’s say, a User is proving that they have $1000 on their bank account, and the TLS Response from the bank’s website is “Good morning Mike; account number: 123; balance: 1000”. If Reclaim asks the user to disclose one number only (the number that represents the balance), then it would be extremely easy for a User to brute-force the key such that the decryption contains “1000” even at a specific position in the string. However, we can require a User to disclose more bytes of the TLS response to be sure that it is not just a random number appeared in the decryption but indeed the bank balance of the User. Moreover, since the format of the TLS response is well-known to an Attestor (since it is specified by the provider parameters), a User will have to disclose exactly the same bytes as the real TLS response contains (e.g. “account number: ***; balance: 1000”). This makes the brute-force a way more challenging problem. The reason behind this is that a User has to iterate through 2^N keys, where N is the number of "])</script><script>self.__next_f.push([1,"8:[\"$\",\"article\",null,{\"className\":\"container py-6 prose dark:prose-invert max-w-3xl mx-auto\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"mb-2 text-center\",\"children\":\"Infeasibility of Fake Key Reveal attacks\"}],[\"$\",\"div\",null,{\"className\":\"text-center\",\"children\":[[\"$\",\"div\",null,{\"children\":\"Madhavan Malolan\"}],[\"$\",\"div\",null,{\"children\":\"Oct 12, 2023\"}]]}],[\"$\",\"img\",null,{\"src\":\"/posts/06.jpg\",\"alt\":\"Infeasibility of Fake Key Reveal attacks\",\"className\":\"rounded\",\"width\":1920,\"height\":1080}],[\"$\",\"div\",null,{\"className\":\"flex gap-2 mb-2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"inline-block text-xs font-medium tracking-wider uppercase mt-5 text-blue-600\",\"suppressHydrationWarning\":true,\"children\":\"Code\"}],[\"$\",\"span\",null,{\"className\":\"inline-block text-xs font-medium tracking-wider uppercase mt-5 text-blue-600\",\"suppressHydrationWarning\":true,\"children\":\"Not Code\"}]]}],[[\"$\",\"p\",null,{\"children\":\"The goal of an Adversary in the Fake Key Reveal attacks is to compute a key such that the result of decryption of the TLS response (that came from the Website) using this key will be a plaintext that contains some specific substrings on the Adversary’s choice. Let’s take a closer look at how the Reclaim’s selective disclosure of the Server’s TLS response works to understand how these attacks can potentially harm Reclaim:\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"The Server sends the encrypted TLS response to the Attestor\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"The Attestor transfers this ciphertext further to the User\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"The User decrypts the TLS response using the key K1 (that is unknown to the Attestor, and was derived between the User and the Server during the TLS Handshake phase), and replaces all the symbols they want to hide with a gibberish symbol\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Now, the User wants to trick the Attestor and prove them that this ciphertext can be decrypted into a string that contains some information that the User wants there to be\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"For this purpose the User (somehow) computes a different key K2 such that the encrypted TLS response will be decrypted to a plaintext containing an arbitrary substring (on User’s choice)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"After that, the User creates a zk-proof of knowledge of the key K2, and reveals the result of decryption of the TLS response using K2 to the Attestor. Thus, this revealed plaintext includes the data that the User wanted to show, and not the data that really came from the Website\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"why-does-this-issue-arise\",\"children\":[\"$\",\"a\",null,{\"className\":\"subheading-anchor\",\"aria-label\":\"Link to section\",\"href\":\"#why-does-this-issue-arise\",\"children\":\"Why does this issue arise?\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The issue of the computation of the second key such that it decrypts a chosen ciphertext into a chosen by the Adversary plaintext first got attention in two papers [\",[\"$\",\"a\",null,{\"href\":\"https://eprint.iacr.org/2017/664.pdf\",\"children\":\"1\"}],\", \",[\"$\",\"a\",null,{\"href\":\"https://eprint.iacr.org/2019/016.pdf\",\"children\":\"2\"}],\"]. Those papers offer attacks that can be exploited against differently encryption schemes with authentication tag (AEAD). The issue they emphasize is that under some conditions an encryption scheme with authentication tag does not provide a unique correct decryption (the decryption is considered correct if the authentication tag verification is successful).\"]}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"reclaims-protection-against-such-attacks\",\"children\":[\"$\",\"a\",null,{\"className\":\"subheading-anchor\",\"aria-label\":\"Link to section\",\"href\":\"#reclaims-protection-against-such-attacks\",\"children\":\"Reclaim’s protection against such attacks\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"There are two main reasons why the attack vector mentioned above is infeasible against the Reclaim protocol:\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"First of all, the attacks above are possible if and only if the Adversary (the User in our case) controls or can choose both ciphertexts and keys. This and only this can lead them to exploiting the vulnerabilities mentioned above. However, in Reclaim the User does not control the ciphertext of the Website’s TLS response, and does not control the encryption key (which has been derived following the TLS protocol). This means that the fake key reveal attack is not applicable here.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Second, the success of these attacks is determined by the correct tag check while decrypting the ciphertext. However, in Reclaim there is no tag check at all. The reason behind the absence of tag verification is that Reclaim verifies the content of the decrypted TLS response instead. So, the mechanism of determination of success or failure of an attack would work differently in our case. This also means that attacks mentioned above are not applicable here.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"These all lead the Adversary to the only strategy they can use against Reclaim in order to perform a fake key reveal attack: a key brute-force. The key brute-force attack, however, would be quite easy for an adversary to perform if Reclaim does not require Users to disclose enough (known in advance by an Attestor) bytes of TLS response.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$14\",[\"$\",\"em\",null,{\"children\":\"bits\"}],\" they have to disclose. In the case of Reclaim, we require Users to disclose 16 bytes of data. Hence, even if a User exploits one of the most high-speed ChaCha20 implementations (560 MB/s encryption speed) it will take them about \",[\"$\",\"em\",null,{\"children\":\"200 trillion years\"}],\" to perform such a brute-force.\"]}]]]}]\n"])</script><script>self.__next_f.push([1,"11:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: light)\",\"content\":\"white\"}],[\"$\",\"meta\",\"2\",{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: dark)\",\"content\":\"black\"}],[\"$\",\"meta\",\"3\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"4\",{\"children\":\"Infeasibility of Fake Key Reveal attacks | Reclaim Protocol\"}],[\"$\",\"meta\",\"5\",{\"name\":\"description\",\"content\":\"The provenance of an object is the history of ownership or the origin or the object. Analogously, the provenance of data is the origin of the data, and the changes that may have been made over time by different owners.\"}],[\"$\",\"meta\",\"6\",{\"name\":\"author\",\"content\":\"hexclanlabs\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:title\",\"content\":\"Infeasibility of Fake Key Reveal attacks\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:description\",\"content\":\"The provenance of an object is the history of ownership or the origin or the object. Analogously, the provenance of data is the origin of the data, and the changes that may have been made over time by different owners.\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:url\",\"content\":\"https://example.com/posts/fake-key-reveal\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:image\",\"content\":\"https://example.com/api/og?title=Infeasibility+of+Fake+Key+Reveal+attacks\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:image:height\",\"content\":\"630\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:image:alt\",\"content\":\"Infeasibility of Fake Key Reveal attacks\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:title\",\"content\":\"Infeasibility of Fake Key Reveal attacks\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:description\",\"content\":\"The provenance of an object is the history of ownership or the origin or the object. Analogously, the provenance of data is the origin of the data, and the changes that may have been made over time by different owners.\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:image\",\"content\":\"https://example.com/api/og?title=Infeasibility+of+Fake+Key+Reveal+attacks\"}],[\"$\",\"link\",\"19\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}],[\"$\",\"meta\",\"20\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script>self.__next_f.push([1,"7:null\n"])</script></body></html>